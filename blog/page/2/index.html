
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Because yes</title>
  <meta name="author" content="Marc Morera">

  
  <meta name="description" content="Barcelona, one of the best cities in the world. For you, Symfony lover. Do you know where is Barcelona, right?
Well, this is a call for all Symfony &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  

  <!-- og:meta -->
  <meta property="og:title" content="" />
  <meta property="og:type" content="article" />
  <meta property="og:url" content="http://mmoreram.com/blog/page/2/" />
  

  <link rel="canonical" href="http://mmoreram.com/blog/page/2/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Because yes" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=Raleway:100" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic|Istok+Web:400,400italic,700,700italic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-41917921-3']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body>
  <div id="header-container">
    <div id="header">
      <div class="wrapper">
        <header role="banner"><hgroup>
  <h1><a href="/">Because yes</a></h1>
</hgroup>

</header>
        <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:mmoreram.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
      </div>
    </div>
  </div>
  <div id="body"   >
    <div id="main">
      <div id="content">
	<div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/08/23/symfony-in-barcelona/">Symfony in Barcelona</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-08-23T17:22:00+02:00" pubdate data-updated="true">Aug 23<span>rd</span>, 2015</time>
        
         | <a href="/blog/2015/08/23/symfony-in-barcelona/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Barcelona, one of the best cities in the world.</p>

<p>For you, Symfony lover. Do you know where is Barcelona, right?
Well, this is a call for all Symfony lovers who want something special,
something really different. Amazing people, amazing food and tons and tons of
new experiences with one of the greatest Symfony Communities around the world.</p>

<iframe width="1280" height="720" src="http://www.youtube.com/embed/6DxX1DYHOlk?feature=player_detailpage&VQ=HD720" frameborder="0" allowfullscreen></iframe>


<p>A lot of companies are actually being built in this city, so we really want you
with us. No matter your Symfony expertise, no matter how good you really are&hellip;
in Barcelona only matters one simple thing&hellip; How good you want to be. If you
want to be one of the bests, then Barcelona can be your new home :)</p>

<p>If you want to know more about it, just send an email to Symfony Barcelona User
Group and you will be properly helped to move here with us. The group email is
<a href="&#109;&#97;&#x69;&#x6c;&#116;&#x6f;&#58;&#x73;&#x79;&#x6d;&#x66;&#x6f;&#110;&#121;&#98;&#97;&#x72;&#x63;&#101;&#x6c;&#x6f;&#x6e;&#x61;&#64;&#103;&#109;&#x61;&#105;&#108;&#46;&#x63;&#111;&#109;">&#x73;&#x79;&#x6d;&#102;&#x6f;&#110;&#x79;&#x62;&#x61;&#114;&#x63;&#x65;&#x6c;&#x6f;&#110;&#97;&#x40;&#x67;&#109;&#97;&#x69;&#108;&#x2e;&#x63;&#x6f;&#x6d;</a></p>

<p>You want to join us, but you don&rsquo;t know it yet :)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/08/20/re-thinking-event-listeners/">Re-thinking Event Listeners</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-08-20T12:27:00+02:00" pubdate data-updated="true">Aug 20<span>th</span>, 2015</time>
        
         | <a href="/blog/2015/08/20/re-thinking-event-listeners/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Let&rsquo;s talk about Event Listeners.
Do you know what an Event Listener is?</p>

<p>Well, if you are used to working with Symfony, then you should know what is
intended for. If you don&rsquo;t, don&rsquo;t hesitate to take a look at the Symfony
documentation.</p>

<p>This post aims to start a small discussion about how an Event Listener should
look like if we really want to keep things decoupled.</p>

<h2>TL;DR</h2>

<ul>
<li>If we place our business logic inside the Event Listeners, we will not be able
to use this logic from other points, for example sending a &ldquo;Order created&rdquo; email
by hand from our Admin using a simple button.</li>
<li>What we could do is place ALL the logic inside a service that ONLY sends that
email, exposing a simple and documented api.</li>
<li>Then, considering that this service is injectable using any Dependency
Injection implementation, we can inject it into the Event Listener.</li>
<li>So, EventListeners are only a point of entry to your service layer</li>
</ul>


<h2>Using Event Listeners</h2>

<p>To understand what I am talking about, let&rsquo;s use an small example to make things
more clear&hellip;</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Scenario: You buy something in an e-commerce, so, internally, your Cart became 
</span><span class='line'>an Order. Of course, and because user experience is important in that cases, you 
</span><span class='line'>want to send an email to the user with some Order information, so you need to 
</span><span class='line'>send an email to the Customer.
</span><span class='line'>
</span><span class='line'>Problem: You want to create this feature in a very decoupled way, of course. The
</span><span class='line'>e-commerce framework provides you that way, by proposing you an event once the
</span><span class='line'>Order is created. You can access the Order itself and the Customer.
</span><span class='line'>
</span><span class='line'>Solution: Create a new Event Listener object, subscribed to this event called
</span><span class='line'>order.oncreate, and sending that email.</span></code></pre></td></tr></table></div></figure>


<p>Let&rsquo;s see a small example about how this Event Listener should look like. We
will follow the simple way, only focusing about sending that email in a
decoupled way with the action.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="k">class</span> <span class="nc">OrderEmailEventListener</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="sd">/**</span>
</span><span class='line'><span class="sd">     * We send an email to the Customer once an order is created</span>
</span><span class='line'><span class="sd">     *</span>
</span><span class='line'><span class="sd">     * @param OrderOnCreatedEvent $event Event</span>
</span><span class='line'><span class="sd">     */</span>
</span><span class='line'>    <span class="k">public</span> <span class="k">function</span> <span class="nf">sendEmail</span><span class="p">(</span><span class="nx">OrderOnCreatedEvent</span> <span class="nv">$event</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="nv">$order</span> <span class="o">=</span> <span class="nv">$event</span><span class="o">-&gt;</span><span class="na">getOrder</span><span class="p">();</span>
</span><span class='line'>        <span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$event</span><span class="o">-&gt;</span><span class="na">getCustomer</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>        <span class="sd">/**</span>
</span><span class='line'><span class="sd">         * Send the email</span>
</span><span class='line'><span class="sd">         */</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>And we could use this configuration in our bundle.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='yaml'><span class='line'><span class="l-Scalar-Plain">services</span><span class="p-Indicator">:</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">#</span>
</span><span class='line'>    <span class="c1"># Event Listeners</span>
</span><span class='line'>    <span class="c1">#</span>
</span><span class='line'>    <span class="l-Scalar-Plain">project.event_listener.order_created_email</span><span class="p-Indicator">:</span>
</span><span class='line'>        <span class="l-Scalar-Plain">class</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">My\Bundle\EventListener\OrderCreatedEmailEventListener</span>
</span><span class='line'>        <span class="l-Scalar-Plain">tags</span><span class="p-Indicator">:</span>
</span><span class='line'>            <span class="p-Indicator">-</span> <span class="p-Indicator">{</span> <span class="nv">name</span><span class="p-Indicator">:</span> <span class="nv">kernel.event_listener</span><span class="p-Indicator">,</span> <span class="nv">event</span><span class="p-Indicator">:</span> <span class="nv">order.oncreate</span><span class="p-Indicator">,</span> <span class="nv">method</span><span class="p-Indicator">:</span> <span class="nv">sendEmail</span> <span class="p-Indicator">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>So this could be a simple implementation. I&rsquo;ve been using it since the beginning
of times as this could be considered a good practice. But, during this time
doing more and more Event Listeners, some questions have come to my mind.</p>

<h2>Decoupling from the Event</h2>

<p>Let&rsquo;s consider that our project has an admin panel. Of course, we should be able
to send this email any time we need (for example, our email server was down
during the order conversion and we must re-send it). Is this possible with this
implementation?</p>

<p>Yes. Let&rsquo;s do this considering that we have injected our EventListener and this
one is accessible locally!</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="nv">$event</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OrderCreatedEmailEventListener</span><span class="p">(</span>
</span><span class='line'>    <span class="nv">$order</span><span class="p">,</span>
</span><span class='line'>    <span class="nv">$customer</span>
</span><span class='line'><span class="p">);</span>
</span><span class='line'><span class="nv">$orderCreatedEmailEventListener</span><span class="o">-&gt;</span><span class="na">sendEmail</span><span class="p">(</span><span class="nv">$event</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Well, this piece of code will really send the email&hellip; but is this
implementation enough right? I don&rsquo;t think so&hellip;</p>

<p>This Event should only be dispatched when the real event happens. It has no
sense to create a new <code>OrderEmailEventListener</code> instance without using the
event dispatcher. This means that, indeed, any Order has been created.</p>

<p>So first of all, creating a new Event out of turn, is not a good practice at
all.</p>

<p>For solving this, We could do that.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="k">class</span> <span class="nc">OrderCreatedEmailEventListener</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="sd">/**</span>
</span><span class='line'><span class="sd">     * We send an email to the Customer once an order is created</span>
</span><span class='line'><span class="sd">     *</span>
</span><span class='line'><span class="sd">     * @param OrderOnCreatedEvent $event Event</span>
</span><span class='line'><span class="sd">     */</span>
</span><span class='line'>    <span class="k">public</span> <span class="k">function</span> <span class="nf">sendEmail</span><span class="p">(</span><span class="nx">OrderOnCreatedEvent</span> <span class="nv">$event</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="nv">$order</span> <span class="o">=</span> <span class="nv">$event</span><span class="o">-&gt;</span><span class="na">getOrder</span><span class="p">();</span>
</span><span class='line'>        <span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$event</span><span class="o">-&gt;</span><span class="na">getCustomer</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">sendOrderCreatedEmail</span><span class="p">(</span>
</span><span class='line'>            <span class="nv">$order</span><span class="p">,</span>
</span><span class='line'>            <span class="nv">$customer</span>
</span><span class='line'>        <span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="sd">/**</span>
</span><span class='line'><span class="sd">     * We send an email to the Customer once an order is created, given the </span>
</span><span class='line'><span class="sd">     * order and the customer</span>
</span><span class='line'><span class="sd">     *</span>
</span><span class='line'><span class="sd">     * @param OrderInterface    $order    Order</span>
</span><span class='line'><span class="sd">     * @param CustomerInterface $customer Customer</span>
</span><span class='line'><span class="sd">     */</span>
</span><span class='line'>    <span class="k">public</span> <span class="k">function</span> <span class="nf">sendOrderCreatedEmail</span><span class="p">(</span>
</span><span class='line'>        <span class="nx">OrderInterface</span> <span class="nv">$order</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">CustomerInterface</span> <span class="nv">$customer</span>
</span><span class='line'>    <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="sd">/**</span>
</span><span class='line'><span class="sd">         * Send the email</span>
</span><span class='line'><span class="sd">         */</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>And then, we could do this</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="nv">$orderCreatedEmailEventListener</span><span class="o">-&gt;</span><span class="na">sendOrderCreatedEmail</span><span class="p">(</span>
</span><span class='line'>    <span class="nv">$order</span><span class="p">,</span>
</span><span class='line'>    <span class="nv">$customer</span>
</span><span class='line'><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Much better, right?
But is this good enough? No is not.</p>

<h2>Decoupling from the Listener</h2>

<p>We are using an instance of an Event Listener to send an email. Our analysis
could be exactly the same than before&hellip; Should we use an Event Listener even
when an event is not dispatched?</p>

<p>No we should not.</p>

<p>An Event Listener is an event listener. Listens one event, and that should be
all its work. So, we should never inject any event listener, anywhere. Let&rsquo;s do
some refactor here!</p>

<p>First of all, let&rsquo;s isolate our business logic in a new service. This service
will <strong>only</strong> do one thing; sending this email.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="k">class</span> <span class="nc">OrderCreatedEmailSender</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="sd">/**</span>
</span><span class='line'><span class="sd">     * We send an email to the Customer once an order is created, given the </span>
</span><span class='line'><span class="sd">     * order and the customer</span>
</span><span class='line'><span class="sd">     *</span>
</span><span class='line'><span class="sd">     * @param OrderInterface    $order    Order</span>
</span><span class='line'><span class="sd">     * @param CustomerInterface $customer Customer</span>
</span><span class='line'><span class="sd">     */</span>
</span><span class='line'>    <span class="k">public</span> <span class="k">function</span> <span class="nf">sendEmail</span><span class="p">(</span>
</span><span class='line'>        <span class="nx">OrderInterface</span> <span class="nv">$order</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">CustomerInterface</span> <span class="nv">$customer</span>
</span><span class='line'>    <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="sd">/**</span>
</span><span class='line'><span class="sd">         * Send the email</span>
</span><span class='line'><span class="sd">         */</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>This service has only one mission. Sending this email, no matter what event
executes it, no matter its environment. So if we take a look at what the Event
Listener implementation should look like now&hellip;</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="k">class</span> <span class="nc">OrderCreatedEmailEventListener</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="sd">/**</span>
</span><span class='line'><span class="sd">     * @var OrderCreatedEmailSender</span>
</span><span class='line'><span class="sd">     *</span>
</span><span class='line'><span class="sd">     * Order created email sender</span>
</span><span class='line'><span class="sd">     */</span>
</span><span class='line'>    <span class="k">private</span> <span class="nv">$orderCreatedEmailSender</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="sd">/**</span>
</span><span class='line'><span class="sd">     * Constructor</span>
</span><span class='line'><span class="sd">     *</span>
</span><span class='line'><span class="sd">     * @param OrderCreatedEmailSender $orderCreatedEmailSender</span>
</span><span class='line'><span class="sd">     */</span>
</span><span class='line'>    <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">(</span><span class="nx">OrderCreatedEmailSender</span> <span class="nv">$orderCreatedEmailSender</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">orderCreatedEmailSender</span> <span class="o">=</span> <span class="nv">$orderCreatedEmailSender</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="sd">/**</span>
</span><span class='line'><span class="sd">     * We send an email to the Customer once an order is created</span>
</span><span class='line'><span class="sd">     *</span>
</span><span class='line'><span class="sd">     * @param OrderOnCreatedEvent $event Event</span>
</span><span class='line'><span class="sd">     */</span>
</span><span class='line'>    <span class="k">public</span> <span class="k">function</span> <span class="nf">sendEmail</span><span class="p">(</span><span class="nx">OrderOnCreatedEvent</span> <span class="nv">$event</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="nv">$order</span> <span class="o">=</span> <span class="nv">$event</span><span class="o">-&gt;</span><span class="na">getOrder</span><span class="p">();</span>
</span><span class='line'>        <span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$event</span><span class="o">-&gt;</span><span class="na">getCustomer</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>        <span class="nv">$this</span>
</span><span class='line'>            <span class="o">-&gt;</span><span class="na">orderCreatedEmailSender</span>
</span><span class='line'>            <span class="o">-&gt;</span><span class="na">sendEmail</span><span class="p">(</span>
</span><span class='line'>                <span class="nv">$order</span><span class="p">,</span>
</span><span class='line'>                <span class="nv">$customer</span>
</span><span class='line'>            <span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Finally, we should refactor as well the way we have defined our service in the
DependencyInjection config file.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='yaml'><span class='line'><span class="l-Scalar-Plain">services</span><span class="p-Indicator">:</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">#</span>
</span><span class='line'>    <span class="c1"># Business layer</span>
</span><span class='line'>    <span class="c1">#</span>
</span><span class='line'>    <span class="l-Scalar-Plain">project.business.order_created_email_sender</span><span class="p-Indicator">:</span>
</span><span class='line'>        <span class="l-Scalar-Plain">class</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">My\Bundle\Business\OrderCreatedEmailSender</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">#</span>
</span><span class='line'>    <span class="c1"># Event Listeners</span>
</span><span class='line'>    <span class="c1">#</span>
</span><span class='line'>    <span class="l-Scalar-Plain">project.event_listener.order_created_email</span><span class="p-Indicator">:</span>
</span><span class='line'>        <span class="l-Scalar-Plain">class</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">My\Bundle\EventListener\OrderCreatedEmailEventListener</span>
</span><span class='line'>        <span class="l-Scalar-Plain">arguments</span><span class="p-Indicator">:</span>
</span><span class='line'>            <span class="p-Indicator">-</span> <span class="err">@</span><span class="l-Scalar-Plain">project.business.order_created_email_sender</span>
</span><span class='line'>        <span class="l-Scalar-Plain">tags</span><span class="p-Indicator">:</span>
</span><span class='line'>            <span class="p-Indicator">-</span> <span class="p-Indicator">{</span> <span class="nv">name</span><span class="p-Indicator">:</span> <span class="nv">kernel.event_listener</span><span class="p-Indicator">,</span> <span class="nv">event</span><span class="p-Indicator">:</span> <span class="nv">order.oncreate</span><span class="p-Indicator">,</span> <span class="nv">method</span><span class="p-Indicator">:</span> <span class="nv">sendEmail</span> <span class="p-Indicator">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>And that&rsquo;s all.
This example is so easy and simple, but I am sure that if you take a look at
your project, you will find a lot of logic inside your Event Listeners. Maybe
could be a good idea start moving all this logic out of the box, treating these
listeners as real entry points, like we do with our Commands, Controllers or
Twig extensions.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/05/18/defeating-expression-language/">Defeating Expression Language</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-05-18T09:53:00+02:00" pubdate data-updated="true">May 18<span>th</span>, 2015</time>
        
         | <a href="/blog/2015/05/18/defeating-expression-language/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>How beautiful Expression Language definitions are, right? I mean, inserting that
complex expressions in a Dependency Injection configuration file is so nice and
fast if you need to inject the result of a method in a service (one of the
multiple examples we can see)</p>

<p>Let&rsquo;s see a simple example of how we use this library.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='yaml'><span class='line'><span class="l-Scalar-Plain">services</span><span class="p-Indicator">:</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">#</span>
</span><span class='line'>    <span class="c1"># My managers</span>
</span><span class='line'>    <span class="c1">#</span>
</span><span class='line'>    <span class="l-Scalar-Plain">some_manager</span><span class="p-Indicator">:</span>
</span><span class='line'>        <span class="l-Scalar-Plain">class</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">This\Is\My\Manager</span>
</span><span class='line'>        <span class="l-Scalar-Plain">arguments</span><span class="p-Indicator">:</span>
</span><span class='line'>            <span class="p-Indicator">-</span> <span class="err">@</span><span class="l-Scalar-Plain">=service(&quot;another_manager&quot;).someCall(&quot;value&quot;)</span>
</span><span class='line'>            <span class="p-Indicator">-</span> <span class="err">@</span><span class="l-Scalar-Plain">=service(&quot;yet_another_manager&quot;).getInjectableInstance(parameter(&quot;my_parameter&quot;))</span>
</span></code></pre></td></tr></table></div></figure>


<p>This is not a bad idea, really, but because we are engineers and we should have
as much information as possible in order to be able to choose between the best
option, always, I will show you another way of defining this piece of code.</p>

<p>Let&rsquo;s do that!</p>

<h3>Factories</h3>

<p>Remember the <a href="http://mmoreram.com/blog/2013/12/23/factory-pattern-in-symfony2/">Factory pattern in Symfony2</a>
post I wrote some time ago? I talked about how this pattern can be implemented
in your Symfony projects.</p>

<p>Well, just for your information, most of your Expression Language definitions
can be nicely done using Factories.</p>

<p>Let&rsquo;s reproduce the same example using factories.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='yaml'><span class='line'><span class="l-Scalar-Plain">services</span><span class="p-Indicator">:</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">#</span>
</span><span class='line'>    <span class="c1"># My managers</span>
</span><span class='line'>    <span class="c1">#</span>
</span><span class='line'>    <span class="l-Scalar-Plain">some_manager</span><span class="p-Indicator">:</span>
</span><span class='line'>        <span class="l-Scalar-Plain">class</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">This\Is\My\Manager</span>
</span><span class='line'>        <span class="l-Scalar-Plain">arguments</span><span class="p-Indicator">:</span>
</span><span class='line'>            <span class="p-Indicator">-</span> <span class="err">@</span><span class="l-Scalar-Plain">my_injectable_value</span>
</span><span class='line'>            <span class="p-Indicator">-</span> <span class="err">@</span><span class="l-Scalar-Plain">my_injectable_service</span>
</span><span class='line'>
</span><span class='line'>    <span class="l-Scalar-Plain">my_injectable_value</span><span class="p-Indicator">:</span>
</span><span class='line'>        <span class="l-Scalar-Plain">class</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">StdClass</span>
</span><span class='line'>        <span class="l-Scalar-Plain">factory</span><span class="p-Indicator">:</span>
</span><span class='line'>            <span class="p-Indicator">-</span> <span class="err">@</span><span class="l-Scalar-Plain">another_manager</span>
</span><span class='line'>            <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">someCall</span>
</span><span class='line'>        <span class="l-Scalar-Plain">arguments</span><span class="p-Indicator">:</span>
</span><span class='line'>            <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">value</span>
</span><span class='line'>
</span><span class='line'>    <span class="l-Scalar-Plain">my_injectable_service</span><span class="p-Indicator">:</span>
</span><span class='line'>        <span class="l-Scalar-Plain">class</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">This\Is\My\Injectable\Class</span>
</span><span class='line'>        <span class="l-Scalar-Plain">factory</span><span class="p-Indicator">:</span>
</span><span class='line'>            <span class="p-Indicator">-</span> <span class="err">@</span><span class="l-Scalar-Plain">yet_another_manager</span>
</span><span class='line'>            <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">getInjectableInstance</span>
</span><span class='line'>        <span class="l-Scalar-Plain">arguments</span><span class="p-Indicator">:</span>
</span><span class='line'>            <span class="p-Indicator">-</span> <span class="err">%</span><span class="l-Scalar-Plain">my_parameter%</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Dependency</h3>

<p>Take a look and realise that we&rsquo;ve removed a package dependency from your
project, as you don&rsquo;t need <code>symfony/expression-language</code> anymore, and your DIC
definition will be easily exportable to another format if someday is needed.</p>

<h3>Reflexion</h3>

<p>Is Expression Language a bad choice? Well, only you should be able to know if
using this library is a good choice or not, because only you know your needs and
your resources, but every time you add a new Expression Language line, just ask
yourself&hellip;</p>

<p>Can I use simple DI definitions here? Is the only way I can do that?</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/05/08/crowdfunding-soundtrack-the-event/">Crowdfunding Soundtrack - El Evento</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-05-08T17:29:00+02:00" pubdate data-updated="true">May 8<span>th</span>, 2015</time>
        
         | <a href="/blog/2015/05/08/crowdfunding-soundtrack-the-event/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><blockquote><p>This post is written in Spanish, but I will translate it soon. Stay tuned for
the translation :D</p></blockquote>

<p>Finalmente, y después de unas semanas cociendo la idea, valorando pros y contras
y el impacto que puede tener en mi vida personal lo que os voy a contar, he
decidido tirar para delante la idea más estúpida que se me ha podido ocurrir en
los 29 años de edad que tengo.</p>

<p>En pocas palabras, a modo introductorio y declarativo.</p>

<p>La idea es hacer una iniciativa CrowdFunding durante un periodo de 3 meses y
conseguir el dinero suficiente para cumplir los siguientes objetivos.</p>

<ul>
<li>Dado una <a href="http://open.spotify.com/user/mmoreramerino/playlist/76u4iXLIFxO3PMFWfwYk5A">lista de spotify</a>
donde he agrupado mis temas favoritos de bandas sonoras, que una Orquestra
Sinfónica interprete los temas en un evento público.</li>
<li>Yo, por mi parte, estudiar durante un periodo de tiempo dirección de orquestra
básico. Evidentemente lo justo para entender los conceptos necesarios y
defenderme.</li>
<li>Dirigir yo, personalmente, uno de los temas.</li>
<li>Donar absolutamente todo el dinero que se recaude en el evento (entradas,
dinero que no se haya gastado después de la iniciativa) al desarrollo y la
investigación de la sordera. Aún estoy buscando organización, universidad o
instituto.</li>
<li>Cumplir uno de mis retos personales, y con ello, ayudar a que otros cumplan
los suyos.</li>
</ul>


<p>Si en este punto sigues leyendo sin pensar que estoy mal de la cabeza,
recapacita; lo estoy. Aún así, eso no debería impedir que uno haga lo que
realmente quiere hacer, pues <em>que seríamos sin sueños estúpidos, solo estúpidos
sin sueños</em>.</p>

<h2>Los temas musicales</h2>

<p>Podéis encontrar el enlace de la lista de Spotify en el parágrafo anterior (debo
decir que falta un track de &ldquo;La Roca&rdquo; inexistente en Spotify. A continuación
adjunto dicha lista.</p>

<ul>
<li>The chase &ndash; The Rock</li>
<li>I don&rsquo;t think now it the best time &ndash; Pirates of the Caribbean &ndash; At world&rsquo;s end</li>
<li>A dark knight &ndash; The dark knight</li>
<li>Flight &ndash; Man of Steel</li>
<li>Comming back around &ndash; How to train your dragon</li>
<li>Spectres in the fog &ndash; The last samurai</li>
<li>The all spark &ndash; Transformers</li>
<li>My name is Lincoln &ndash; The island</li>
<li>War &ndash; Pearl Harbor</li>
<li>Chevaliers de Sangreal &ndash; The Da Vinci Code</li>
<li>Sound the Buggle now &ndash; Spirit, Stallion of the Cimarron</li>
<li>Run Free &ndash; Spirit, Stallion of the Cimarron</li>
<li>The Wheat &ndash; Gladiator</li>
<li>The Battle &ndash; Gladiator</li>
</ul>


<p>Cada uno de estos temas compone la banda sonora de mi vida.</p>

<h2>Crowdfunding</h2>

<p>Algunos os preguntaréis&hellip; bueno Marc, y todo esto cuanto vale? Pues aún estoy
trabajando en ello, pero es bastante dinero. Calculo que alrededor de unos
200.000 euros para ser específicos.</p>

<p>No tengo aún muy claro como voy a configurar los niveles de colaboración
(hay distintos mínimos de aportaciones, y cada uno de ellos te proporciona un
retorno de cierto nivel. En este caso el retorno será reducido para maximizar el
volumen de donación final)</p>

<p>Lo que si tengo claro es el tipo de público al que va la iniciativa.</p>

<ul>
<li>Patrocinadores &ndash; Empresas que quieran hacer que esto sea posible. Serán los
niveles de patrocinio más altos.</li>
<li>Individuales &ndash; Todo aquel que quiera hacer una donación a la investigación y
quiera que el evento ocurra podrá hacerlo mediante dicho evento. A partir de uno
de los niveles de patrocinio, habrá entrada gratuita al evento.</li>
<li>Aportaciones &ndash; Fuera del evento crowdfunding también se aceptarán donaciones,
aunque es preferible que todas entren por el evento.</li>
</ul>


<h2>La plataforma</h2>

<p>Finalmente, y después de solucionar un dilema mental que tenía entre si hacerlo
internacional o local, he decidido ejecutar el evento a nivel español. Para esto
trataré de utilizar la plataforma <a href="http://www.verkami.com/">Verkami</a> dado que
tengo muy buenas referencias.</p>

<h2>El porqué</h2>

<p>En realidad, últimamente estoy hablando mucho de emprendedores y de intentar
todo aquello que crees que deberías intentar. La idea de hacer eventos me gusta
mucho, de hecho soy organizador de un evento en Barcelona bastante chulo, aunque
local, por el momento.</p>

<p>El hecho también que me guste la música hasta límites indecentes hace que quiera
poner toda la carne en el asador, sin preguntarme demasiado el porqué hago todo
esto. Creo ser un músico frustrado y siempre me quedará el intentar, por todos
los medios posibles e imposibles, cumplir alguno de mis hitos indiscutibles.</p>

<p>El dirigir una orquestra es uno de ellos. Desde hace muchos años.</p>

<p>Y como he dicho alguna vez, el mejor consejo que me han dado nunca en mi vida ha
sido &ldquo;No lo intentes&rdquo;, por lo que, haciendo caso omiso a las personas vacías de
locura, no lo voy a intentar, lo voy a hacer.</p>

<h2>Próximos pasos</h2>

<ul>
<li>En unos días voy a colgar la iniciativa en Verkami.</li>
<li>Hacer ruido. Mucho ruido. Demostrar que todo es posible.</li>
<li>Buscar organización o similar para donar todo el dinero ganado.</li>
<li>Trabajar bien el evento y todas las piezas componen organizar un
acontecimiento de estas características.</li>
<li>Encontrar un grupo de gente motivada con la idea que quiera ayudarme una vez
se cierre la iniciativa con resultado positivo.</li>
<li>Seguir trabajando en la idea, hasta el final.</li>
</ul>


<p>Si quieres estar actualizado sobre el evento, puedes seguir-me en
<a href="http://twitter.com/mmoreram">Twitter</a> o suscribirte a mi blog, desde donde voy
a escribir de forma periódica todas las actualizaciones sobre el evento.</p>

<p>Saludos a todos.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/05/08/lazy-commands-in-symfony/">Lazy Commands in Symfony</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-05-08T11:04:00+02:00" pubdate data-updated="true">May 8<span>th</span>, 2015</time>
        
         | <a href="/blog/2015/05/08/lazy-commands-in-symfony/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Have you ever had this scenario?</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>php app/console doctrine:database:drop --force
</span><span class='line'><span class="nv">$ </span>php app/console doctrine:database:create
</span><span class='line'>
</span><span class='line'>    <span class="o">[</span>Doctrine<span class="se">\D</span>BAL<span class="se">\E</span>xception<span class="se">\C</span>onnectionException<span class="o">]</span>
</span><span class='line'>    An exception occured in driver: SQLSTATE<span class="o">[</span>42000<span class="o">]</span> <span class="o">[</span>1049<span class="o">]</span> Unknown database <span class="s1">&#39;mydatabase&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Well, it happens and I will tell you why.</p>

<h2>Command as a Service</h2>

<p>Since Symfony version 2.4 you can define your controllers and commands as
services. This is so useful as long as you need to treat your classes as much
decoupled as possible. You can check some information about how to define them
as services in
<a href="http://symfony.com/doc/current/cookbook/console/commands_as_services.html">Symfony Documentation</a>.</p>

<p>Then, let&rsquo;s figure out that our command is intended to check an entity from your
database. Of course, your command should be as empty as possible, placing all
your business logic inside your service layer (this is not the only strategy, of
course, but there is no strategy where you lace your logic inside your command).</p>

<p>Then, using commands as services, you will have this</p>

<ul>
<li>ObjectManager as a service (or Repository)</li>
<li>Your service, intended to do whatever you need to do, for example, check that
your entities are all enabled. Your ObjectManager or Repository will be injected
here</li>
<li>Your command, intended to work as the simple layer between your cli interface
and your service layer. Your service will be injected here.</li>
</ul>


<p>Given this schema, when we require this command through the DI Container, of
course a new Service instance will be created in order to inject it through the
command constructor, and the object will have to be created as well to be
injected inside the service.</p>

<p>It means create a new connection to the database. Fair enough till now :)</p>

<h2>Commands list</h2>

<p>Let me show you some lines of code. This method is placed in a class called
<code>Application</code> inside the bundle <code>FrameworkBundle</code>. This class is intended to add
the possibility of adding Commands as services in the main Application class of
Command Component.</p>

<p><a href="https://github.com/symfony/symfony/blob/2.7/src/Symfony/Bundle/FrameworkBundle/Console/Application.php">Symfony\Bundle\FrameworkBundle\Console\Application</a></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="k">protected</span> <span class="k">function</span> <span class="nf">registerCommands</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="nv">$container</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">kernel</span><span class="o">-&gt;</span><span class="na">getContainer</span><span class="p">();</span>
</span><span class='line'>    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">kernel</span><span class="o">-&gt;</span><span class="na">getBundles</span><span class="p">()</span> <span class="k">as</span> <span class="nv">$bundle</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="nv">$bundle</span> <span class="nx">instanceof</span> <span class="nx">Bundle</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="nv">$bundle</span><span class="o">-&gt;</span><span class="na">registerCommands</span><span class="p">(</span><span class="nv">$this</span><span class="p">);</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nv">$container</span><span class="o">-&gt;</span><span class="na">hasParameter</span><span class="p">(</span><span class="s1">&#39;console.command.ids&#39;</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$container</span><span class="o">-&gt;</span><span class="na">getParameter</span><span class="p">(</span><span class="s1">&#39;console.command.ids&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="nv">$id</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="nv">$container</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nv">$id</span><span class="p">));</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Oh, wait&hellip; what?</p>

<p>Register a command means instantiate it! So if we have a command with a service
injected which has an object manager injected&hellip; then we have a problem. If we
don&rsquo;t have the database created we will not be able to create it using the
Doctrine command.</p>

<p><em>~ironic~ Perfect scenario for deployment ~/ironic~</em></p>

<h2>Using Lazy services</h2>

<p>Of course we should find a solution for this scenario, in order to be able to
call this command when is needed.</p>

<p>When we define as lazy a service, this is not instanced when is injected, but
only when is accessed. You can find some information about lazy services in
<a href="http://symfony.com/doc/current/components/dependency_injection/lazy_services.html">Symfony Documentation</a>.</p>

<p>The point here is to define our service intended to work with the model as lazy.
The result will be that when we instance the Command, then a proxy object is
created and injected with all the service information.</p>

<p>Because our command will not be used as long as we don&rsquo;t need it, then the
service will not be instanced and the ObjectManager not created. We will be able
to list all the commands, and finally, call
<code>php app/console doctrine:database:create</code> properly.</p>

<h2>Implementation</h2>

<p>Some tips here&hellip;</p>

<ul>
<li>Why instancing all services when we just need them to be listed? Is it really
necessary? Doing than we are forcing some service to be defined as lazy just
because of it, and this is not and will never be a good practice.</li>
<li>If the command needs to be instanced to be listed, and assuming that this
information <del>should</del> could be cached, then, is it necessary to call the
constructor? We could get the class, build the object using <code>\ReflectionClass</code>
and request all the needed information.</li>
</ul>


<p>I invoke the community for some feedback on that. If this is really a need for
some people, we should do some push (and organize us for an implementation,
maybe) to change this implementation for next Symfony 3 version.</p>

<p>Feedback, feedback :)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/05/07/montando-a-pau-garcia-mila/">Montando a Pau Garcia-Milà</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-05-07T02:58:00+02:00" pubdate data-updated="true">May 7<span>th</span>, 2015</time>
        
         | <a href="/blog/2015/05/07/montando-a-pau-garcia-mila/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Hace apenas unas semanas, en un diario nacional español, aparecía un escrito
inquietante, al menos a simple vista, sobre algunos puntos discutibles alrededor
del ya más que conocido emprendedor Pau Garcia-Milà.</p>

<p><a href="http://www.eldiario.es/hojaderouter/emprendedores/pau_garcia-mila-emprendimiento-EyeOS-Bananity_0_369213079.html">Post original</a></p>

<p>Para los interesados, decir que el propio Pau respondió días más tarde en su
blog, respondiendo a ciertas afirmaciones.</p>

<p><a href="http://paugarciamila.com/desmontando-a-pau-garcia-mila/">Respuesta de Pau</a></p>

<p>En dicho escrito, se analizan algunos de los puntos importantes y críticos por
los que nuestro protagonista ha pasado durante los últimos años, dejando al
lector la tarea de leer a simple vista un gran elenco de comentarios de algunas
personas cuya opinión se les fue requerida, entiendo yo.</p>

<p>Antes de todo decir escuetamente que yo recuerdo a Pau en sus inicios, cuando
empezó a ser un personaje público. Añadir también que, tras un tiempo teniéndolo
en mi <em>top of mind</em> como referencia y recordándolo como
<em>simplemente, brillante</em>, y por alguna razón que no logré entender durante mucho
tiempo, pasó a ser mi <em>vende-humos</em> favorito.</p>

<blockquote><p>Éste no ha hecho nada. Solo habla de ideas. Yo también tengo muchas ideas!
Mirad! Un percebe con alas! Fundemos una empresa que se llame Engonga
associated y conquistemos el mundo. Ah, no, esperad, que con una idea uno no
tiene ni para empezar&hellip; Nada, vuelvo al mundo real, en mi sofá de pensar.</p></blockquote>

<p>Pero gracias a Dios, a veces en la vida te encuentras a grandes personas que te
bautizan de golpe como <em>ex-hater</em>, y te das cuenta que el odio es,
habitualmente, proporcional a la envidia, y quién mejor que una persona a la que
envidias para empezar a admirar.</p>

<p>He aquí mi pequeño paso hacia la redención relativa. Mi objetivo, la completa
madurez. :)</p>

<h3>Reflexiones</h3>

<p>En este post, y como persona emprendedora que creo ser, añado algunas respuestas
a comentarios del post original sin entrar demasiado al detalle.</p>

<blockquote><p>Ha empezado cosas, pero no ha terminado ninguna. Son habilidades distintas.
Creo que es un grandísimo comunicador y tiene éxito con eso, pero como
emprendedor no lo ha demostrado</p></blockquote>

<p>En realidad esta frase es la que más me duele a mi, como emprendedor que soy.
Hace un poco más de un año y medio que trabajo en un proyecto, y siento decir
que, por ahora, no he demostrado nada a nadie. ¿Eso me convierte en menos
emprendedor?</p>

<p>Trabajo un mínimo de 80 horas semanales en un proyecto de código libre de índole
internacional, llevo una comunidad de desarrolladores Web local cuyos eventos
son referenciados en todo el mundo, tengo unos cuantos proyectos personales
también de código libre utilizados en multitud de empresas reales, y en el
tiempo más libre de mi tiempo libre, soy ponente en eventos alrededor del globo.</p>

<p>¿Demostrado? Si se refiere a si he vendido alguna empresa por 20 millones de
euros, pues no&hellip; ¿Emprendedor? Hombre, pues creo que algo si, ¿no?</p>

<p>Debo decir con gran aplomo que ningún emprendedor tiene que demostrar nada a
nadie para serlo, y es que la palabra emprendedor, uno, se la gana con el
trabajo y el sudor, no con los éxitos (y menos midiendo los éxitos en cifras
o en rondas de inversión).</p>

<p>Emprendedor es el que crea sitios de trabajo, el que crea equipos sanos y
empresas con ideales humanos. Emprendedor es quien no se rinde a pesar de sus
innumerables fracasos. Emprendedor es el que tras un &ldquo;No lo vas a conseguir&rdquo; ve
un &ldquo;Debes conseguirlo&rdquo;.</p>

<p>Emprendedor es quien persigue lo que todo el mundo ha dejado por imposible.</p>

<p>Está claro que Pau es un gran comunicador y también está claro que ha tenido
éxito con ello, pero seamos realistas y no nos dejemos llevar por la envidia y
el descontrol: Un chico que a los 28 años ha tratado de levantar 3 empresas (la
cuarta recientemente) y haya vendido una, cuales fueran las condiciones de dicha
transacción y cuya información no me interesa en absoluto, absolutamente nadie
puede tacharle de no ser emprendedor (evidentemente mencionar sus libros,
charlas y todo el ecosistema que ha creado alrededor).</p>

<p>Yo me quito el sombrero, al menos, por haberlo intentado.</p>

<p>Pero está claro que es más simple y fácil entrar en la crítica destructiva y
sensacionalista. Nos alimenta mucho más el ego interior y nos hace sentir más
fuertes a nosotros, seres iluminados. Pero la realidad es que tras la fachada de
un comunicador como Pau hay, en la mayoría de los casos, una mente brillante y
un trabajo constante. Otra cosa es tener interés en conocer este trabajo y
valorarlo como se debe.</p>

<p>Que difícil es hacer esto.</p>

<blockquote><p>pero hay grandes emprendedores en España que son menos mediáticos. Mi
experiencia me dice que el éxito de un emprendedor es inversamente
proporcional a sus seguidores en Twitter. No suele ser mediático.</p></blockquote>

<p>El número de seguidores que tiene una persona en Twitter es directamente
proporcional a varios elementos, como el campo en que esta persona haya decidido
ser emprendedor (no es lo mismo un químico que un informático) o el carácter
comunicativo que dicha persona tenga en su personalidad (No es lo mismo una
persona expansiva y sociable que una persona itrovertida y tímida).</p>

<p>Algunos ejemplos rápidos.</p>

<ul>
<li>Bill Gates, co-fundador de Microsoft, <strong>21.8 millones</strong> de followers</li>
<li>Steve Wozniak, co-fundador de Apple, <strong>402 mil</strong> followers</li>
<li>Elon Musk, fundador de Tesla y PayPal, <strong>2.06 millones</strong> de followers</li>
<li>Jimmy Wales, fundador de Wikipedia, <strong>110 mil</strong> followers</li>
<li>Charles W. Hull, inventor de la impresora 3D (nada, es posible que solo
revolucione el modelo industrial en los próximos años)&hellip; <strong>0</strong> followers</li>
<li>Steve Chen, co-fundador de Youtube, <strong>3599</strong> followers</li>
</ul>


<p>Podría seguir, pero carece de sentido categorizar a estos emprendedores como
ejemplos de qué es tener poco éxito&hellip; Personas como ellas hacen que la sociedad
avance en campos como la medicina, la tecnología o el bienestar.</p>

<p>Evidentemente esto no quita que hay emprendedores de éxito abismal que, por
decisión propia, han preferido quedarse en segundo plano en temas sociales. Y
esta es una decisión igual de factible, correcta e indiscutible que cualquier
otra.</p>

<blockquote><p>Tenemos que animar con credibilidad. Lo bueno es que nos fijemos en los que ya
han tenido éxito, porque es lo que cuenta: si no, se genera la sensación de
que esto no es serio</p></blockquote>

<p>Comentario propio del que lo tuvo todo muy fácil.</p>

<p>Precisamente la gente necesita ver a personas que lo intentan a pesar de que las
cosas van en contra, y aceptar que fallar nos hace aún más humanos. La
credibilidad se demuestra con los caminos que uno hace a lo largo de su vida, la
credibilidad la marca la honestidad y la ley del esfuerzo, sea cual sea el
resultado final.</p>

<p>Adjudicar seriedad al grado de éxito es, a mi parecer, una falta de respeto para
los que aún no hemos conseguido nada, aún lo intentemos con todas nuestras
fuerzas. Y lo que me parece más grave, me parece una falta de respeto
innecesaria, un comentario fuera de lugar y una doctrina tóxica para una
sociedad desanimada y desorientada como es la nuestra.</p>

<p>Reflexión, por favor.</p>

<h3>Conclusión</h3>

<p>Emprendedor, no emprendedor. Da igual, lo importante para una sociedad es el
esfuerzo. Hable en público, tenga seguidores en Twitter o toque la pandereta con
los ojos cerrados y en sol sostenido, son elementos personales, injuzgables más
allá de uno mismo, y menos cuando el impacto social es positivo, mires por donde
lo mires.</p>

<p>Repito una frase con la que empezaba mi post dado que encuentro interesante y
reveladora.</p>

<blockquote><p>el odio es, habitualmente, proporcional a la envidia, y quién mejor que una
persona a la que envidias para empezar a admirar</p></blockquote>

<p>Mi consejo siempre es el mismo. Que el miedo a intentar cosas no os impida no
hacerlas, y que simplemente os hagan más cautos. No os dejéis llevar por la
mediocridad social a la hora de juzgar a personas que trabajan por su futuro y
sed críticos más allá de 4 medios de comunicación de intenciones puramente
marketinianas.</p>

<p>Dicho esto, sed felices y volad cometas.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/05/04/visithor/">Visithor, Testing Your Routes Without Pain</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-05-04T13:11:00+02:00" pubdate data-updated="true">May 4<span>th</span>, 2015</time>
        
         | <a href="/blog/2015/05/04/visithor/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Do you like testing? I like testing. Well, in fact I like testing once I have
understood how the engine I am using works. Until this moment, everything is a
completely disaster.</p>

<p>And because this learning curve, many of my personal projects have reached an
MVP without any type of testing environment. And sincerely, I don&rsquo;t really like
this scenario.</p>

<p>Many years ago I was thinking about a <strong>simple</strong> and fast tool to test specific
routes, expecting specific HTTP codes and providing an easy environment of
ensuring properly your HTTP layer.</p>

<p>So&hellip; I present you <a href="http://github.com/visithor/visithor">Visithor</a>, a PHP based
library that provides you this functionality, with a simple configuration
definition and a very easy way of installation.</p>

<p>Let&rsquo;s see an example.</p>

<h2>Execute Visithor</h2>

<p>With this lines of code you will download Visithor, ready to be used.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>git clone git@github.com:visithor/visithor.git
</span><span class='line'><span class="nv">$ </span><span class="nb">cd </span>visithor
</span><span class='line'><span class="err">$</span>
</span><span class='line'><span class="nv">$ </span>build/visithor.phar
</span></code></pre></td></tr></table></div></figure>


<p>You can download it as a global executable</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>git clone git@github.com:visithor/visithor.git
</span><span class='line'><span class="nv">$ </span><span class="nb">cd </span>visithor
</span><span class='line'><span class="nv">$ </span>cp build/visithor.phar /usr/local/bin/visithor
</span><span class='line'><span class="err">$</span>
</span><span class='line'><span class="nv">$ </span>visithor
</span></code></pre></td></tr></table></div></figure>


<h2>Creating your configuration</h2>

<p>As easy as it seems. This is a random configuration file with a random set of
urls. If your <code>visithor.yml</code> file is placed in the same folder than you are,
then you don&rsquo;t have to specify its location. Otherwise, please use the
<em>[&mdash;config|-c]</em> option.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='yaml'><span class='line'><span class="l-Scalar-Plain">defaults</span><span class="p-Indicator">:</span>
</span><span class='line'>    <span class="c1">#</span>
</span><span class='line'>    <span class="c1"># This value can be a simple HTTP Code or an array of acceptable HTTP Codes</span>
</span><span class='line'>    <span class="c1"># - 200</span>
</span><span class='line'>    <span class="c1"># - [200, 301]</span>
</span><span class='line'>    <span class="c1">#</span>
</span><span class='line'>    <span class="l-Scalar-Plain">http_codes</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="nv">200</span><span class="p-Indicator">,</span> <span class="nv">302</span><span class="p-Indicator">]</span>
</span><span class='line'>
</span><span class='line'><span class="l-Scalar-Plain">urls</span><span class="p-Indicator">:</span>
</span><span class='line'>    <span class="c1">#</span>
</span><span class='line'>    <span class="c1"># By default, is there is no specified HTTP Code, then default one is used</span>
</span><span class='line'>    <span class="c1"># as the valid one</span>
</span><span class='line'>    <span class="c1">#</span>
</span><span class='line'>    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">http://google.es</span>
</span><span class='line'>    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">http://elcodi.io</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">#</span>
</span><span class='line'>    <span class="c1"># There are some other formats available as well</span>
</span><span class='line'>    <span class="c1">#</span>
</span><span class='line'>    <span class="p-Indicator">-</span> <span class="p-Indicator">[</span><span class="nv">http</span><span class="p-Indicator">:</span><span class="nv">//shopery.com</span><span class="p-Indicator">,</span> <span class="nv">200</span><span class="p-Indicator">]</span>
</span><span class='line'>    <span class="p-Indicator">-</span> <span class="p-Indicator">[</span><span class="nv">http</span><span class="p-Indicator">:</span><span class="nv">//mmoreram.com</span><span class="p-Indicator">,</span> <span class="p-Indicator">[</span><span class="nv">200</span><span class="p-Indicator">,</span> <span class="nv">302</span><span class="p-Indicator">]]</span>
</span><span class='line'>    <span class="p-Indicator">-</span> <span class="p-Indicator">[</span><span class="nv">http</span><span class="p-Indicator">:</span><span class="nv">//nonexistingurl.com</span><span class="p-Indicator">,</span> <span class="p-Indicator">[</span><span class="nv">200</span><span class="p-Indicator">]]</span>
</span></code></pre></td></tr></table></div></figure>


<p>In this case, the execution result is <em>0</em></p>

<h2>Executing Visithor</h2>

<p>Once you have it installed and you have a configuration file, let&rsquo;s see what
happens!</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='yaml'><span class='line'><span class="l-Scalar-Plain">$ visithor visithor:go</span>
</span><span class='line'>
</span><span class='line'><span class="l-Scalar-Plain">Visithor by Marc Morera and contributors.</span>
</span><span class='line'>
</span><span class='line'><span class="l-Scalar-Plain">Configuration read from /var/www/my/project</span>
</span><span class='line'>
</span><span class='line'><span class="l-Scalar-Plain">OK [200] http://google.es</span>
</span><span class='line'><span class="l-Scalar-Plain">OK [200] http://elcodi.io</span>
</span><span class='line'><span class="l-Scalar-Plain">OK [200] http://shopery.com</span>
</span><span class='line'><span class="l-Scalar-Plain">OK [200] http://mmoreram.com</span>
</span><span class='line'><span class="l-Scalar-Plain">KO [404] http://nonexistingurl.com</span>
</span><span class='line'>
</span><span class='line'><span class="l-Scalar-Plain">Time</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">1002 ms, Memory</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">15.5Mb</span>
</span></code></pre></td></tr></table></div></figure>


<p>As you can see, we have an error. We expect a <code>200</code> code when we call
<code>http://nonexistingurl.com</code> but the real response is <code>404</code>, so it fails. Then,
the execution result is <em>1</em>.</p>

<h2>Integrations</h2>

<p>You can integrate Visithor with your Symfony projects right now. I expect some
other integrations will be available soon.</p>

<ul>
<li><a href="http://github.com/Visithor/VisithorBundle">VisithorBundle</a></li>
</ul>


<p>If you use this bundle, then you will be able to define your routes not with the
final path but with the route name and a bunch of parameters, as it is shown
here.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='yaml'><span class='line'><span class="l-Scalar-Plain">defaults</span><span class="p-Indicator">:</span>
</span><span class='line'>    <span class="c1">#</span>
</span><span class='line'>    <span class="c1"># This value can be a simple HTTP Code or an array of acceptable HTTP Codes</span>
</span><span class='line'>    <span class="c1"># - 200</span>
</span><span class='line'>    <span class="c1"># - [200, 301]</span>
</span><span class='line'>    <span class="c1">#</span>
</span><span class='line'>    <span class="l-Scalar-Plain">http_codes</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="nv">200</span><span class="p-Indicator">,</span> <span class="nv">302</span><span class="p-Indicator">]</span>
</span><span class='line'>
</span><span class='line'><span class="l-Scalar-Plain">urls</span><span class="p-Indicator">:</span>
</span><span class='line'>    <span class="c1">#</span>
</span><span class='line'>    <span class="c1"># This Bundle adds some extra formats</span>
</span><span class='line'>    <span class="c1">#</span>
</span><span class='line'>    <span class="p-Indicator">-</span> <span class="p-Indicator">[</span><span class="nv">store_homepage</span><span class="p-Indicator">,</span> <span class="nv">200</span><span class="p-Indicator">]</span>
</span><span class='line'>    <span class="p-Indicator">-</span> <span class="p-Indicator">[[</span><span class="nv">store_category_products_list</span><span class="p-Indicator">,</span> <span class="p-Indicator">{</span><span class="s">&#39;slug&#39;</span><span class="p-Indicator">:</span> <span class="s">&#39;women-shirts&#39;</span><span class="p-Indicator">,</span> <span class="s">&#39;id&#39;</span><span class="p-Indicator">:</span> <span class="nv">1</span><span class="p-Indicator">}],</span> <span class="nv">200</span><span class="p-Indicator">]</span>
</span><span class='line'>    <span class="p-Indicator">-</span> <span class="p-Indicator">[[</span><span class="nv">store_category_products_list</span><span class="p-Indicator">,</span> <span class="p-Indicator">{</span><span class="s">&#39;slug&#39;</span><span class="p-Indicator">:</span> <span class="s">&#39;another-name&#39;</span><span class="p-Indicator">,</span> <span class="s">&#39;id&#39;</span><span class="p-Indicator">:</span> <span class="nv">1</span><span class="p-Indicator">}],</span> <span class="nv">302</span><span class="p-Indicator">]</span>
</span><span class='line'>    <span class="p-Indicator">-</span> <span class="p-Indicator">[[</span><span class="nv">store_homepage</span><span class="p-Indicator">,</span> <span class="p-Indicator">{</span><span class="nv">_locale</span><span class="p-Indicator">:</span> <span class="nv">es</span><span class="p-Indicator">}]]</span>
</span></code></pre></td></tr></table></div></figure>


<p>This project is being so useful for me, I expect it will be for you as well :)</p>

<h2>Travis</h2>

<p>Of course, you can add Visithor in your travis tests suite. You can use the
[&mdash;format|-f] option to change the format and use <em>dots</em></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='yaml'><span class='line'><span class="l-Scalar-Plain">script</span><span class="p-Indicator">:</span>
</span><span class='line'>    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">bin/behat -fprogress --tags=&quot;~javascript&quot;</span>
</span><span class='line'>    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">bin/phpunit -c app</span>
</span><span class='line'>    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">bin/visithor --format=dots visithor:go</span>
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/04/25/behat-and-data-test/">Behat and Data-test</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-04-25T16:31:00+02:00" pubdate data-updated="true">Apr 25<span>th</span>, 2015</time>
        
         | <a href="/blog/2015/04/25/behat-and-data-test/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Tests should be as robust as possible.</p>

<p>I think you will agree with me with that phrase. If your tests are too coupled
with your implementation, a simple modification of your code will need the
modification of your tests, and that&rsquo;s so annoying, right?</p>

<p>I&rsquo;ve using Behat for the last months in my projects, and as soon as you dominate
the tool it becomes really useful to make sure that any future refactoring or
change will break these user stories you have already defined and tested.</p>

<p>So, thinking about coupling I saw this method in Behat implementation.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="sd">/**</span>
</span><span class='line'><span class="sd"> * Presses button with specified id|name|title|alt|value.</span>
</span><span class='line'><span class="sd"> *</span>
</span><span class='line'><span class="sd"> * @When /^(?:|I )press &quot;(?P&lt;button&gt;(?:[^&quot;]|\\&quot;)*)&quot;$/</span>
</span><span class='line'><span class="sd"> */</span>
</span><span class='line'><span class="k">public</span> <span class="k">function</span> <span class="nf">pressButton</span><span class="p">(</span><span class="nv">$button</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="c1">//</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>What do you think? Do you think that this method helps people to really decouple
the tests from their implementation? I don&rsquo;t really think so&hellip; Let me explain.</p>

<h3>Design v Test</h3>

<p>My question is&hellip; should the frontend of your website be aware of the how your
Behat tests are built? In my opinion, <strong>nope</strong>.</p>

<p>Your tests should live in a simple layout on top of your application, emulating
some cases and ensuring that your users will be able to do what they should be
able to.</p>

<p>Said this, you cannot build your tests depending on final implementation. So,
whats the problem there?</p>

<h3>HTML Properties</h3>

<p>Dear backend. Between you and me&hellip; we have nothing to do with some html
properties, and you know that&hellip; This is the frontend world and we have nothing
to say about that :)</p>

<p>So why referring to html property <code>id</code> in your Behat cases? It has no sense
indeed. You will need to change <strong>all</strong> your tests every time your frontend
says&hellip; <em>refactoring time!!</em>, and we have no enough time for this, right?</p>

<p>So&hellip; first property strikethrough.</p>

<h3>Translations</h3>

<p>Dear backend (again, yes). Between you and me&hellip; we have neither nothing to do
with translations, and we both know as well that translations is something
really changeable (that means evolving&hellip; so yes, that are good news indeed), so
how about coupling your fantastic tests to translations?</p>

<p>How do you really know that your submission button copy will be always <code>send</code>?
What if someone thinks that is better <code>submit</code>? The point is that you <strong>don&rsquo;t</strong>
know that, and you will never do.</p>

<p>If you don&rsquo;t want to do that, please, don&rsquo;t use <code>title</code>, <code>alt</code> nor <code>value</code>. All
these html properties are very used to changing if you use them properly, so if
you have your site in several countries with some modifications, you will not be
able to reuse any scenario.</p>

<p>Bad choice again.</p>

<h3>Symfony Forms</h3>

<p>We still have the <code>name</code> property, a very important property for forms and
references inside your DOM. In fact, too much important to be an starting point
for your test cases.</p>

<p>For example, you can fill a value in a Symfony Form input, but you know what?
Symfony Forms define themselves how their forms are named, in order to know how
to build them again after submitting them.</p>

<p>If you use <code>name</code> property, and for example you have different teams for
developing your applications and for testing them, you will add an extra and
useless coupling layer between them. This means more <em>points of failure</em> and, at
the end, less agility.</p>

<p>Not valid.</p>

<h3>So what?</h3>

<p>Well, this is a <em>problem</em> really easy to solve. Have you ever meet the property
<code>data-test</code>? You can build any property starting with <code>data-</code> and will be okay.
So, in that case you can safely reference your elements using it.</p>

<ul>
<li>Your front-ends have nothing to do with it. They will see <code>data-test</code> and will
know that they belong to the testing layer. Then, they will ignore it, and even
if they decide to refactor a page, they will preserve this property (if they
can and want, of course) and your tests will not have any reason to expire.</li>
<li>Your tests will have nothing to do with translation, product people and other
tactical nor strategical changes.</li>
<li>People of your team will now have a unique way of referencing visible elements
of your application.</li>
</ul>


<p>That&rsquo;s so nice!</p>

<h3>Implementation</h3>

<p>Well, after this analysis, I propose to add <code>data-test</code> in all pre-defined
selectors in order to allow people to uncouple from implementation.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="sd">/**</span>
</span><span class='line'><span class="sd"> * Presses button with specified id|name|title|alt|value|data-test.</span>
</span><span class='line'><span class="sd"> *</span>
</span><span class='line'><span class="sd"> * @When /^(?:|I )press &quot;(?P&lt;button&gt;(?:[^&quot;]|\\&quot;)*)&quot;$/</span>
</span><span class='line'><span class="sd"> */</span>
</span><span class='line'><span class="k">public</span> <span class="k">function</span> <span class="nf">pressButton</span><span class="p">(</span><span class="nv">$button</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="c1">//</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Please, I would like to have some feedback, specially if you are used to working
with Behat or any kind of Behavioral Testing Tool.</p>

<p>Thanks and enjoy your day!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/04/05/reflexiones-de-un-pequeno-emprendedor/">Reflexiones De Un Pequeño Emprendedor</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-04-05T01:58:00+02:00" pubdate data-updated="true">Apr 5<span>th</span>, 2015</time>
        
         | <a href="/blog/2015/04/05/reflexiones-de-un-pequeno-emprendedor/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Ya hace un poco más de un año que estoy a bordo de este proyecto llamado Elcodi.
Para los que no conozcáis el proyecto, solo unas simples pistas&hellip;</p>

<ul>
<li>E-commerce</li>
<li><a href="https.//symfony.com">Symfony</a></li>
<li><a href="https://github.com/elcodi/elcodi">Elcodi</a></li>
</ul>


<p>Hace bastantes semanas que tenía ganas de formular una entrada al blog de
éste índole. Normalmente intento hacer mis posts en inglés, pero me pareció
adecuado hacer éste en español, dado que lo hago desde una perspectiva más de
emprendedor que no de técnico.</p>

<blockquote><p>Debo decir brevemente que no me gusta la palabra &ldquo;emprendedor&rdquo;. Durante los
últimos años se le ha dado un significado demasiado Trending y se le ha
asociado a figuras de visibilidad pública. Desde mi punto de vista,
emprendedor es aquel que se desvive por su trabajo, sea cual sea, y que lo
entiende como una forma de vida. Utilizaré esta palabra desde esta perspectiva</p></blockquote>

<p>Os quiero contar de forma bastante breve lo que, después de éste tiempo,
considero son algunos puntos importantes de un emprendedor.
Considerando que soy una persona formada de forma pura en el mundo técnico y que
he experimentado una transición un poco brusca hacia el mundo de la
emprendeduría empresarial, quiero dejar claro que estos son mis puntos de vista
dada mi trayectoria, por lo que es probable que algunos no sean mundialmente
compartidos por todos.</p>

<h3>La Idea</h3>

<p>Tengo la sensación que se le asigna demasiado valor a la idea. Como se suele
decir, la idea no vale <strong>nada</strong>. Una semilla tal vez, nada más. El auténtico valor
reside en considerar ésta misma idea importante durante el tiempo adecuado. El
mérito está en mantener la expectativa y la motivación en su punto más álgido lo
suficiente como para que la ejecución tome la mínima forma como para que sea
algo real.</p>

<p>Es en este punto es donde te das cuenta que lo más fácil en realidad fue tener
dicha idea, y que lo más cómodo hubiera sido dejar de lado la motivación para
hacer algo más significativo a corto plazo.</p>

<p>El auténtico emprendedor entiende de raíz que dicho esfuerzo, con su parte
proporcional y proporcionada de suerte, ayuda y café, siempre acaba siendo más
rentable para todo el mundo a largo plazo.</p>

<h3>El Desarrollo</h3>

<p>Todo proceso que te lleva de la mano de ésta idea amorfa hasta la definición y
ejecución de la misma requiere un esfuerzo que, en la mayoría de los casos, te
aísla de forma inconsciente de todo lo demás.</p>

<blockquote><p>Quien dice emprendedor, dice luchador
Luchador cuya soledad le invade en su lucha
Y en medio del silencio oye su respiración
Y entiende su existencia</p></blockquote>

<p>Es un gran ejercicio de descubrimiento personal. Te das cuenta de lo que puedes,
de los que sabes y de lo que eres capaz. Y cuando crees que no puedes saber más,
te das cuenta que apenas sabes nada. Aprendes a aprender mientras aprendes a
desaprender.</p>

<p>Hasta aquí un intento descarado y fracasado de poesía. Ahora vuelvo a la simple
y terrenal prosa, más digna de mi focalizado potencial&hellip;</p>

<p>Ha sido el año más duro y a la vez delicioso de mi carrera profesional. He
aprendido a lidiar con mentes completamente distintas a la mía, y esto me ha
dado cierta capacidad de análisis teniendo múltiples puntos de vista, muy
necesario para cualquiera con alguna aspiración empresarial.</p>

<p>Debo decir que a día de hoy sigo sin entender muchas cosas, algo que me hace
seguir siendo lo suficiente ingenuo como para estar demasiado ilusionado por
todo.</p>

<p>De todas formas, el camino sigue, y espero poder seguir teniendo este análisis
absolutamente positivo año tras año&hellip; significará que seguiré en mi lucha por
buscar algo realmente grande, aún habiéndolo encontrado.</p>

<h3>Las Ganas</h3>

<p>Y en éste camino, debo reconocer que el concepto <em>ganas</em>, mundialmente
conocido por <em>motivación</em>, suele experimentar un movimiento sinusoidal más
típico de una montaña rusa del siglo XXI.</p>

<p>Mi único apunte sobre este tema, y es algo que yo he llegado a aprender con el
tiempo, es que una buena técnica para poder sobrevivir a todo esto es teniendo
en cuenta que tu cabeza no tiene siempre la razón. Me refiero a que hay días en
los que los pensamientos negativos parecen la única materia generada por tu
astuto cerebro.</p>

<p>Bien, ignóralo.</p>

<p>¿Días de estos en que, literalmente lo ves todo negro? Bien, quédate en
casa, tómate un respiro y descansa. Te darás cuenta que ignorando estos
pensamientos darás paso de nuevo a otros mejores. Seguro que el día siguiente
puedes seguir como si nada.</p>

<p>Debo decir que a mi me funciona. Mis ganas suelen regenerarse después de un alto
desgaste debido a una frenética entrega o a una época difícil.</p>

<h3>El Equipo</h3>

<p>Y a todo esto hay que añadirle el ingrediente más importante.</p>

<p>El equipo.</p>

<p>De manual. Esta frase suele salir de forma prefabricada de la boca de cualquier
persona que quiera ser algo trending. De todas formas, siempre he pensado que
había otra forma de hacer las cosas que se saliera un poco de la tradicional a
la que nos tienen acostumbrados.</p>

<p>Debo decir que soy de ideas fuertes, y desde que salí de la carrera y durante
mi <em>corta</em> trayectoria profesional me he cruzado con líderes y con jefes. Debo
añadir de forma categórica que hubiera seguido a los líderes hasta los confines
del fracaso, mientras que no hubiera dedicado un solo segundo a buscar el éxito
al lado de ningún jefe.</p>

<p>Y es que los líderes hacen girar el mundo. O dicho mejor, los líderes hacen que
todos hagamos girar el mundo de una forma optimista y valiente.</p>

<p>Dicho esto, y tras haberme cruzado con un poco de todo, decidí que era hora de
poner a prueba mis teorías. El mejor equipo hace la mejor empresa, y para que
sea así, la mejor empresa debe tener el mejor equipo. Y debo reconocer que, si
de por sí no es nada fácil buscar gente para un equipo potente, menos lo es si
tienes en cuenta ciertos parámetros de convivencia, motivación y encaje.</p>

<p>Con el tiempo me he dado cuenta que algo merece gran cantidad de mi fuerza vital
y esfuerzo es buscar un equipo con el que pasar las horas disfrutando de mi
trabajo. Éste equipo será tu mano derecha y tu mano izquierda. Será tu apoyo en
los mejores y peores momentos, y será tu mayor crítico cuando necesites de una
voz sincera y dura.</p>

<p>Mi equipo.</p>

<p>El mejor equipo del mundo.</p>

<h3>Conclusión</h3>

<p>Como podéis ver, y termino, Elcodi es un proyecto sano. Debo reconocer que estoy
abrumado por el equipo humano que tenemos en la empresa. Nuestra máxima
prioridad es que en el día a día del equipo sea lo más agradable posible, y que
el trabajo se convierta en algo realmente fascinante.</p>

<p>Por mi parte estoy satisfecho por todo, con perspectivas de incalculable valor y
rodeado de, literalmente, los mejores compañeros de viaje que uno podría tener.</p>

<p>Mucha suerte y mucha fuerza a todos los que habéis decidido que el camino más
largo y duro es el que mejor encaja en vuestra vida. Os mando mi energía y mis
mayores deseos de éxito.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/01/10/pdd-manifesto/">PDD Manifesto</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-01-10T18:40:00+01:00" pubdate data-updated="true">Jan 10<span>th</span>, 2015</time>
        
         | <a href="/blog/2015/01/10/pdd-manifesto/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Hi everyone.</p>

<p>I&rsquo;ve been talking about PDD for a while. Pragmatism-Driven Development, a
methodology that takes in account the development environment and the
circumstances before of deciding the tools and the architectural decisions of
your projects.</p>

<p><a href="http://mmoreram.com/blog/2014/10/26/pdd-pragmatic-driven-development-english/">Pragmatic Driver Development</a></p>

<p>Some people asked me for the manifesto. And because I think that some people
will appreciate another way of doing things more realistic, I started the first
draft of that manifesto some time ago.</p>

<p>After discussions with the ecosystem where I work, finally, I can release the
first version of the manifesto.</p>

<p>These are just some ideas, not a dogma, so please, don&rsquo;t use them as the only
way of doing things, making the same mistake again and again.</p>

<p>I will appreciate as well your constructive comments, so the real objective of
that kind of things are, indeed, to make people more comfortable with their
projects.</p>

<p>The more useful projects, the more knowledge shared, the more fun for everyone.</p>

<p>Be happy!</p>

<h2>PDD Manifesto</h2>

<h3>Good practices</h3>

<ul>
<li>All good practice is only good if it is.</li>
<li>A good practice is good, indeed, if the executor knows it enough.</li>
<li>Otherwise, a good practice becomes always a bad practice; Ipso Facto.</li>
</ul>


<h3>Bad practices</h3>

<ul>
<li>All bad practice can be accepted, if, and only if, is well known by the executor.</li>
<li>Knowing them means to have a strict control of your current bad practices.</li>
<li>The absence of this control turns any bad practice in a poorly executed project.</li>
</ul>


<h3>Analyzing</h3>

<ul>
<li>Every project must be analyzed according to needs and own tools.</li>
<li>Accepting that these needs and tools are static is accepting their failure.</li>
<li>Starting a project destined to fail is the worst practice of all.</li>
</ul>


<h3>Evolving</h3>

<ul>
<li>These needs can change along the time, so the tools have to change as well.</li>
<li>Internal and staff training is essential for the evolution of a team, and therefore a project.</li>
<li>All components of such team must evolve to self-acceptance and practice of good practices.</li>
</ul>

</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/3/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2017/02/16/bldd-a-dd-to-dominate-them-all/">BLDD, a DD to dominate them all</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/02/04/el-peligro-de-hablar-espanol-en-catalunya/">El peligro de hablar español en Catalunya</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/01/26/bldd-un-dd-para-dominarlos-a-todos/">BLDD, un DD para dominarlos a todos</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/03/03/symfony-catalunya/">Symfony Catalunya</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/02/09/you-probably-need-bundle-dependencies/">you probably need bundle dependencies</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/mmoreram">@mmoreram</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'mmoreram',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

      </div>
    </div>
    <footer role="contentinfo"><p>
  Copyright &copy; 2017 - Marc Morera -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a>. Design by <a href="http://octopressthemes.com">Octopress Themes</a>.</span>
</p>

</footer>
    

<script type="text/javascript">
      var disqus_shortname = 'mmoreram';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





  </div>
</body>
</html>
