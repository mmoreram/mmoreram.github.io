
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Behat and data-test - Because yes</title>
  <meta name="author" content="Marc Morera">

  
  <meta name="description" content="Tests should be as robust as possible. I think you will agree with me with that phrase. If your tests are too coupled
with your implementation, a &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://mmoreram.github.io/blog/2015/04/25/behat-and-data-test/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Because yes" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=Raleway:100" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic|Istok+Web:400,400italic,700,700italic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-41917921-3']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body>
  <div id="header-container">
    <div id="header">
      <div class="wrapper">
        <header role="banner"><hgroup>
  <h1><a href="/">Because yes</a></h1>
</hgroup>

</header>
        <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:mmoreram.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
      </div>
    </div>
  </div>
  <div id="body"   >
    <div id="main">
      <div id="content">
	<div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Behat and Data-test</h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-04-25T16:31:00+02:00" pubdate data-updated="true">Apr 25<span>th</span>, 2015</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>Tests should be as robust as possible.</p>

<p>I think you will agree with me with that phrase. If your tests are too coupled
with your implementation, a simple modification of your code will need the
modification of your tests, and that&rsquo;s so annoying, right?</p>

<p>I&rsquo;ve using Behat for the last months in my projects, and as soon as you dominate
the tool it becomes really useful to make sure that any future refactoring or
change will break these user stories you have already defined and tested.</p>

<p>So, thinking about coupling I saw this method in Behat implementation.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="sd">/**</span>
</span><span class='line'><span class="sd"> * Presses button with specified id|name|title|alt|value.</span>
</span><span class='line'><span class="sd"> *</span>
</span><span class='line'><span class="sd"> * @When /^(?:|I )press &quot;(?P&lt;button&gt;(?:[^&quot;]|\\&quot;)*)&quot;$/</span>
</span><span class='line'><span class="sd"> */</span>
</span><span class='line'><span class="k">public</span> <span class="k">function</span> <span class="nf">pressButton</span><span class="p">(</span><span class="nv">$button</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="c1">//</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>What do you think? Do you think that this method helps people to really decouple
the tests from their implementation? I don&rsquo;t really think so&hellip; Let me explain.</p>

<h3>Design v Test</h3>

<p>My question is&hellip; should the frontend of your website be aware of the how your
Behat tests are built? In my opinion, <strong>nope</strong>.</p>

<p>Your tests should live in a simple layout on top of your application, emulating
some cases and ensuring that your users will be able to do what they should be
able to.</p>

<p>Said this, you cannot build your tests depending on final implementation. So,
whats the problem there?</p>

<h3>HTML Properties</h3>

<p>Dear backend. Between you and me&hellip; we have nothing to do with some html
properties, and you know that&hellip; This is the frontend world and we have nothing
to say about that :)</p>

<p>So why referring to html property <code>id</code> in your Behat cases? It has no sense
indeed. You will need to change <strong>all</strong> your tests every time your frontend
says&hellip; <em>refactoring time!!</em>, and we have no enough time for this, right?</p>

<p>So&hellip; first property strikethrough.</p>

<h3>Translations</h3>

<p>Dear backend (again, yes). Between you and me&hellip; we have neither nothing to do
with translations, and we both know as well that translations is something
really changeable (that means evolving&hellip; so yes, that are good news indeed), so
how about coupling your fantastic tests to translations?</p>

<p>How do you really know that your submission button copy will be always <code>send</code>?
What if someone thinks that is better <code>submit</code>? The point is that you <strong>don&rsquo;t</strong>
know that, and you will never do.</p>

<p>If you don&rsquo;t want to do that, please, don&rsquo;t use <code>title</code>, <code>alt</code> nor <code>value</code>. All
these html properties are very used to changing if you use them properly, so if
you have your site in several countries with some modifications, you will not be
able to reuse any scenario.</p>

<p>Bad choice again.</p>

<h3>Symfony Forms</h3>

<p>We still have the <code>name</code> property, a very important property for forms and
references inside your DOM. In fact, too much important to be an starting point
for your test cases.</p>

<p>For example, you can fill a value in a Symfony Form input, but you know what?
Symfony Forms define themselves how their forms are named, in order to know how
to build them again after submitting them.</p>

<p>If you use <code>name</code> property, and for example you have different teams for
developing your applications and for testing them, you will add an extra and
useless coupling layer between them. This means more <em>points of failure</em> and, at
the end, less agility.</p>

<p>Not valid.</p>

<h3>So what?</h3>

<p>Well, this is a <em>problem</em> really easy to solve. Have you ever meet the property
<code>data-test</code>? You can build any property starting with <code>data-</code> and will be okay.
So, in that case you can safely reference your elements using it.</p>

<ul>
<li>Your front-ends have nothing to do with it. They will see <code>data-test</code> and will
know that they belong to the testing layer. Then, they will ignore it, and even
if they decide to refactor a page, they will preserve this property (if they
can and want, of course) and your tests will not have any reason to expire.</li>
<li>Your tests will have nothing to do with translation, product people and other
tactical nor strategical changes.</li>
<li>People of your team will now have a unique way of referencing visible elements
of your application.</li>
</ul>


<p>That&rsquo;s so nice!</p>

<h3>Implementation</h3>

<p>Well, after this analysis, I propose to add <code>data-test</code> in all pre-defined
selectors in order to allow people to uncouple from implementation.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="sd">/**</span>
</span><span class='line'><span class="sd"> * Presses button with specified id|name|title|alt|value|data-test.</span>
</span><span class='line'><span class="sd"> *</span>
</span><span class='line'><span class="sd"> * @When /^(?:|I )press &quot;(?P&lt;button&gt;(?:[^&quot;]|\\&quot;)*)&quot;$/</span>
</span><span class='line'><span class="sd"> */</span>
</span><span class='line'><span class="k">public</span> <span class="k">function</span> <span class="nf">pressButton</span><span class="p">(</span><span class="nv">$button</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="c1">//</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Please, I would like to have some feedback, specially if you are used to working
with Behat or any kind of Behavioral Testing Tool.</p>

<p>Thanks and enjoy your day!</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Marc Morera</span></span>

      








  


<time datetime="2015-04-25T16:31:00+02:00" pubdate data-updated="true">Apr 25<span>th</span>, 2015</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/behat/'>behat</a>, <a class='category' href='/blog/categories/behavioral/'>behavioral</a>, <a class='category' href='/blog/categories/tests/'>tests</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://mmoreram.github.io/blog/2015/04/25/behat-and-data-test/" data-via="mmoreram" data-counturl="http://mmoreram.github.io/blog/2015/04/25/behat-and-data-test/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2015/04/05/reflexiones-de-un-pequeno-emprendedor/" title="Previous Post: Reflexiones de un pequeño emprendedor">&laquo; Reflexiones de un pequeño emprendedor</a>
      
      
        <a class="basic-alignment right" href="/blog/2015/05/04/visithor/" title="Next Post: Visithor, testing your routes without pain">Visithor, testing your routes without pain &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/05/18/defeating-expression-language/">Defeating Expression Language</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/08/crowdfunding-soundtrack-the-event/">Crowdfunding Soundtrack - El Evento</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/08/lazy-commands-in-symfony/">Lazy Commands in Symfony</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/07/montando-a-pau-garcia-mila/">Montando a Pau Garcia-Milà</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/04/visithor/">Visithor, testing your routes without pain</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/mmoreram">@mmoreram</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'mmoreram',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>


      </div>
    </div>
    <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Marc Morera -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a>. Design by <a href="http://octopressthemes.com">Octopress Themes</a>.</span>
</p>

</footer>
    

<script type="text/javascript">
      var disqus_shortname = 'mmoreram';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://mmoreram.github.io/blog/2015/04/25/behat-and-data-test/';
        var disqus_url = 'http://mmoreram.github.io/blog/2015/04/25/behat-and-data-test/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





  </div>
</body>
</html>
